
# gem5启动流程

当在终端上输入 gem5.opt 后，系统会启动一个 gem5 模拟器实例。具体地，gem5.opt 命令通过解析命令行参数来决定要运行哪种配置和仿真工作负载。下面是 gem5.opt 启动的具体执行顺序和调用过程：

1. 解析命令行参数

   gem5.opt 会解析命令行参数，包括配置文件路径、仿真器类型、工作负载路径等。解析命令行参数的代码位于 src/main.cc 文件中。

2. 初始化系统
  
   gem5.opt 会初始化一个 System 对象，该对象代表了整个系统的配置和状态。这个过程包括读取配置文件、创建处理器、内存控制器、缓存等模块，并将它们连接起来。初始化系统的代码位于 src/sim/init.cc 文件中。

3. 加载工作负载

   根据命令行参数，gem5.opt 会加载指定的工作负载。这可能包括一个二进制可执行文件、一个 Linux 内核镜像文件等。加载工作负载的代码位于 src/sim/se.py 文件中。

4. 运行仿真器

   一切准备就绪后，gem5.opt 开始运行仿真器。仿真器的主要循环位于 src/sim/main.cc 文件中。仿真器循环执行以下步骤：

   - 从系统中的所有事件中选取一个最近的事件
   - 将仿真时间推进到该事件的发生时间
   - 执行事件处理器，可能会修改系统状态
   - 循环直到仿真结束或达到设定的仿真时长
   - 在仿真过程中，gem5.opt 会调用各种模块的函数来模拟处理器、内存、缓存、总线等硬件的行为。

5. 输出仿真结果

   当仿真器结束时，gem5.opt 可以输出一些统计信息、日志和结果文件。输出结果的代码位于 src/sim/output.cc 文件中。

请注意，由于 gem5 是一个高度可配置的仿真平台，具体的执行顺序和调用过程可能因配置和工作负载的不同而有所不同。
